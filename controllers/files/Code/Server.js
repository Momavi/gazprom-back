// Импортируем необходимые библиотеки
const express = require('express');
const bodyParser = require('body-parser');

// Создаем приложение express
const app = express();

// Разрешаем express обрабатывать запросы с JSON данными
app.use(bodyParser.json());

// "База данных" для хранения пользователей (в памяти)
let users = [];

// Маршрут для получения списка всех пользователей
app.get('/users', (req, res) => {
  // Отправляем пользователей обратно клиенту
  res.json(users);
});

// Маршрут для создания нового пользователя
app.post('/users', (req, res) => {
  // Получаем данные пользователя из тела запроса
  let user = req.body;
  // Добавляем пользователя в "базу данных"
  users.push(user);
  // Отправляем статус 200 (ОК) обратно клиенту
  res.sendStatus(200);
});

// Маршрут для обновления существующего пользователя
app.put('/users/:id', (req, res) => {
  // Получаем id пользователя из параметров запроса
  let id = req.params.id;
  // Находим пользователя в "базе данных"
  let user = users.find(u => u.id === id);
  // Обновляем пользователя
  Object.assign(user, req.body);
  // Отправляем статус 200 (ОК) обратно клиенту
  res.sendStatus(200);
});

// Маршрут для удаления пользователя
app.delete('/users/:id', (req, res) => {
  // Получаем id пользователя из параметров запроса
  let id = req.params.id;
  // Удаляем пользователя из "базы данных"
  users = users.filter(u => u.id !== id);
  // Отправляем статус 200 (ОК) обратно клиенту
  res.sendStatus(200);
});

// Запускаем сервер на порту 3000
app.listen(3000, () => {
  console.log('Сервер запущен на порту 3000');
});
